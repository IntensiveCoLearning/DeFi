# Derick

1. 自我介绍: 
2. 你认为你会完成本次残酷学习吗？  **100%**


## Notes

<!-- Content_START -->

### 2024.08.14
- 今天参加了Marcus和q老师的开营启动课，对DeFi有了初步了解
- [第一节课笔记](https://blog.ithuo.net/posts/defi-1-decentralized-finance/)

### 2024.08.19
- 学习这篇[去中心化指数](https://nigdaemon.gitbook.io/how-to-defi-advanced-zhogn-wen-b/di-9-zhang-qu-zhong-xin-hua-zhi-shu)
- 去中心化指数和传统ETF虽然都是追踪某个资产组合的投资工具,但它们之间存在一些重要区别:
1. 发行和管理方式:
   - 传统ETF由中心化的金融机构发行和管理。
   - 去中心化指数由智能合约管理,没有中心化的管理机构。
2. 交易场所:
   - 传统ETF在证券交易所交易。
   - 去中心化指数在去中心化交易所(DEX)交易。
3. 资产托管:
   - 传统ETF的资产由托管机构保管。
   - 去中心化指数的资产直接存储在区块链上的智能合约中。
4. 赎回机制:
   - 传统ETF通常只允许授权参与者进行大额赎回。
   - 去中心化指数允许任何持有者随时赎回基础资产。
5. 监管:
   - 传统ETF受到严格的金融监管。
   - 去中心化指数目前监管较少,处于灰色地带。
### 2024.08.20
- 根据提供的信息，我将总结USDT、USDC和DAI这三种稳定币的产生方式以及限制超发的机制:
## USDT (Tether)
### 产生方式
USDT是由Tether公司发行的中心化稳定币。
### 限制超发机制
- Tether声称每个USDT都由等值的美元储备支持，以实现1:1的价值关系。
- 用户可以通过Chaineye工具查看Tether的资产负债情况和储备金分布。
- 然而，Tether的储备并非完全透明，存在被公司挪用的风险。
## USDC (USD Coin)
### 产生方式
USDC由Centre组织(Coinbase和Circle共同创建)发行的中心化稳定币。
### 限制超发机制
- Circle声称每个USDC都有相应的美元作抵押，存放在需要定期审计和公开报告的账户中。
- USDC的储备金接受审计，提高了透明度。
- 用户可以通过Chaineye工具查看Circle的资产负债情况和储备金分布。
## DAI
### 产生方式
DAI是由MakerDAO发行的去中心化、超额抵押稳定币。
### 限制超发机制
- 用户通过将加密资产(如ETH)作为抵押品锁定在智能合约中来铸造DAI。
- 系统要求维持较高的质押率，以抵御市场波动风险。
- DAI的铸造和销毁过程由智能合约执行，没有中心化托管风险。
- 目前由USDC抵押生成的DAI已超过总量的60%，引发了对其去中心化程度的质疑。
USDT和USDC作为中心化稳定币，主要依赖发行机构的信誉和监管来限制超发。而DAI作为去中心化稳定币，通过智能合约和超额抵押机制来维持稳定性和限制超发。每种稳定币都有其优缺点，用户需要权衡考虑其稳定性、透明度和去中心化程度。
### 2024.08.21
DEX聚合器是去中心化金融(DeFi)生态系统中的重要组成部分,主要用于优化去中心化交易所(DEX)的交易体验。以下是DEX聚合器的主要特点和功能:
## 主要功能
1. **流动性聚合**: 汇集多个DEX的流动性,解决单个DEX流动性不足的问题。
2. **最优路径**: 使用复杂算法寻找最佳交易路径,优化交换率和燃气费用。
3. **订单拆分**: 将大额订单拆分到多个DEX执行,减少价格滑点。
4. **价格比较**: 实时比较不同DEX的报价,帮助用户获得最佳价格。
## 优势
1. **降低交易成本**: 通过优化路径和拆分订单,减少燃气费用和价格影响。
2. **提高效率**: 用户无需手动在多个DEX间比价和交易。
3. **增强流动性**: 整合分散的流动性,提高整体市场效率。
## 代表项目
一些知名的DEX聚合器包括:
- 1inch
- DODO 
- Matcha
- Paraswap
- KyberSwap
- 0x API

### 2024.08.22
了解去中心化借贷的概念
去中心化借贷是去中心化金融(DeFi)生态系统中的一个重要组成部分。以下是对去中心化借贷的主要特点和运作方式的解释:
## 基本概念
去中心化借贷是指在区块链上通过智能合约实现的点对点借贷服务,无需传统金融机构作为中介。
## 主要特点
1. **无需中介**: 借贷双方直接在区块链上进行交互,无需银行等中间机构参与。
2. **智能合约驱动**: 借贷条款和执行过程由智能合约自动管理。
3. **抵押机制**: 借款人通常需要提供加密资产作为抵押品。
4. **流动性池**: 多个贷方的资金汇集在流动性池中,供借款人借贷。
5. **利率市场化**: 利率根据供需关系自动调整。

## 运作流程
1. 贷方将加密资产存入借贷协议的流动性池。
2. 借款人提供抵押品并从流动性池中借出资产。
3. 智能合约自动管理借贷条款,包括利率计算、抵押品监控等。
4. 借款人可随时偿还借款,贷方可随时提取存款及利息。
## 优势
1. **可访问性**: 为全球用户提供金融服务,特别是没有银行账户的人群。
2. **透明度**: 所有交易都记录在区块链上,可公开审计。
3. **效率**: 自动化执行降低了运营成本,提高了效率。
4. **灵活性**: 用户可以灵活地存取资金,调整借贷头寸。
总的来说,去中心化借贷通过区块链技术和智能合约,实现了一个无需信任、高效透明的借贷市场,为传统金融体系带来了创新和挑战。
### 2024.08.23
学习混合器的概念
## 区块链中的混合器：保护隐私的双刃剑
**什么是混合器？**
在区块链的世界中，混合器（Tumbler或Mixer）是一种服务，旨在通过将多个交易合并在一起，来混淆加密货币的来源和去向，从而增强交易的隐私性。想象一下，你把自己的硬币和其他人的硬币放在一个大袋子里，然后重新分配，这样就很难追踪你的硬币最初来自哪里。
**混合器的工作原理**

1. **存款：** 用户将要混淆的加密货币发送到混合器的地址。
2. **混合：** 混合器将收到的所有加密货币混合在一起，形成一个大的交易池。
3. **分配：** 混合器将交易池中的加密货币重新分配给各个用户，确保每个用户收到的加密货币与最初存入的金额相同，但来源已经变得难以追踪。

**混合器的优势**
* **增强隐私：** 混合器可以有效地保护用户的隐私，防止他人追踪资金的流动。
* **提高安全性：** 通过隐藏交易的来源，混合器可以降低被黑客攻击的风险。

**混合器的争议**
* **洗钱工具：** 混合器也被犯罪分子利用来洗钱，掩盖非法活动的资金来源。
* **监管难题：** 由于混合器的匿名性，监管机构很难追踪非法活动，给执法带来了挑战。

**常见的混合器类型**
* **中心化混合器：** 由第三方机构运营，用户需要信任该机构。
* **去中心化混合器：** 基于智能合约运行，无需第三方机构，安全性更高。

**使用混合器的注意事项**
* **法律风险：** 在一些国家和地区，使用混合器是违法的。
* **安全风险：** 选择混合器时，务必选择信誉良好的平台，以避免资金损失。
* **隐私与透明度：** 虽然混合器可以保护隐私，但过度依赖混合器也可能导致监管不力。

**有哪些应用**
* CoinJoin
* Wasabi Wallet
* Tornado Cash

### 2024.08.24
学习uniswap v3 白皮书 第一章
Uniswap v3引入了几个重要的新特性
## 集中流动性
集中流动性是Uniswap v3最重要的创新之一。它允许流动性提供者(LP)将其流动性集中在特定的价格范围内，而不是像之前版本那样均匀分布在整个价格范围内。
- LP可以选择任意价格范围来提供流动性，这被称为"位置"。
- 每个位置只需要维持足够的储备来支持其价格范围内的交易。
- 当价格超出位置的范围时，该位置的流动性变为非活跃状态，不再赚取费用。
- 这大大提高了资本效率，因为LP可以将资金集中在他们预期价格波动的范围内。
## 灵活费用
Uniswap v3不再固定0.30%的交易费率，而是引入了多个费率选项:
- 初始支持的费率包括0.05%、0.30%和1%。
- 每个交易对可以有多个不同费率的资金池。
- UNI代币持有者可以通过治理添加新的费率选项。
这种灵活性允许市场为不同的交易对选择最合适的费率，提高整体效率。
## 改进的价格预言机
Uniswap v3对其时间加权平均价格(TWAP)预言机进行了重大升级:
- 用户不再需要在链外跟踪累加器的先前值。
- 合约内部存储了累加器的检查点，允许外部合约计算最近期间的链上TWAP，无需存储累加器值的检查点。
- 从算术平均TWAP切换到几何平均TWAP，理论上更准确地表示平均价格。
## 流动性预言机
Uniswap v3引入了一个新的流动性累加器:
- 跟踪每秒钟1/L的累积值，其中L是当前范围内的虚拟流动性。
- 这对外部合约实现流动性挖矿非常有用。
- 还可以用于判断哪个资金池的TWAP最可靠。
## 非同质化流动性
与之前版本不同，Uniswap v3中的流动性位置是非同质化的:
- 费用不再自动复投为流动性，而是单独存储。
- 移除了原生流动性代币，为更灵活的外部包装提供了可能性。

### 2024.08.25

### 2024.08.26
- 在测试网创建V3 POOL,存款1eth，交易[hash](https://explorer-holesky.morphl2.io/tx/0x6a6a419876785cca553859d1648b70c0d3004deaab9a037e169a57bf21e25678)
### 2024.08.27
- 了解去中心化中的借贷
去中心化借贷是去中心化金融(DeFi)生态系统中的一个重要组成部分。以下是对去中心化借贷的主要特点和运作方式的解释:
## 基本概念
去中心化借贷是指在区块链上通过智能合约实现的点对点借贷服务,无需传统金融机构作为中介。
## 主要特点
1. **无需中介**: 借贷双方直接在区块链上进行交互,无需银行等中间机构参与。
2. **智能合约驱动**: 借贷条款和执行过程由智能合约自动管理。
3. **抵押机制**: 借款人通常需要提供加密资产作为抵押品。
4. **流动性池**: 多个贷方的资金汇集在流动性池中,供借款人借贷。
5. **利率市场化**: 利率根据供需关系自动调整。
## 运作流程
1. 贷方将加密资产存入借贷协议的流动性池。
2. 借款人提供抵押品并从流动性池中借出资产。
3. 智能合约自动管理借贷条款,包括利率计算、抵押品监控等。
4. 借款人可随时偿还借款,贷方可随时提取存款及利息。
## 优势
1. **可访问性**: 为全球用户提供金融服务,特别是没有银行账户的人群。
2. **透明度**: 所有交易都记录在区块链上,可公开审计。
3. **效率**: 自动化执行降低了运营成本,提高了效率。
4. **灵活性**: 用户可以灵活地存取资金,调整借贷头寸。

### 2024.08.28
Uniswap v3的集中流动性（Concentrated Liquidity）是一项核心创新，允许流动性提供者（LP）在特定的价格范围内提供流动性，从而提高资本效率。以下是集中流动性的具体实现过程：
## 1. 价格范围与位置
在Uniswap v3中，流动性被限制在一个特定的价格范围内，这个范围由两个价格边界（ticks）定义。流动性提供者可以选择任意两个ticks，形成一个位置（position）。
- **Ticks**：每个tick对应一个特定的价格，价格以1.0001的幂表示。流动性提供者可以在任意两个ticks之间提供流动性。
- **位置**：每个位置只需要维持足够的储备以支持其价格范围内的交易，这意味着流动性提供者可以在他们预期价格波动的范围内集中流动性。
## 2. 计算虚拟流动性
当流动性提供者在某个价格范围内提供流动性时，Uniswap v3使用虚拟流动性（virtual liquidity）的概念来描述流动性：
- **虚拟流动性**：在特定价格范围内，流动性提供者的流动性可以被视为一个常数乘积池（constant product pool），其中的虚拟储备通过公式计算得出。
- 公式如下，其中$k$是常数。
```math
L = \sqrt{k}
```
## 3. 位置的状态管理
Uniswap v3通过管理每个位置的状态来实现集中流动性：
- **流动性状态**：每个位置的流动性（L）在被触及时更新。流动性提供者可以通过调用合约函数来增加或减少流动性。
- **费用跟踪**：每个位置还跟踪其未收取的费用，以便在流动性提供者撤回流动性时结算。
## 4. 价格变化与流动性激活
当市场价格在流动性提供者设定的范围内波动时，流动性保持活跃。若价格超出范围：
- **流动性变为非活跃**：当价格超出流动性提供者设定的范围时，该位置的流动性不再参与交易，并且不再赚取费用。
- **重新激活**：如果价格再次进入该范围，流动性会重新激活，流动性提供者将开始赚取费用。
## 5. 跨越ticks的流动性管理
在交易过程中，当价格跨越一个初始化的tick时，Uniswap v3会更新流动性和费用的状态：
- **流动性添加或移除**：当价格跨越tick时，合约会根据tick的状态添加或移除流动性，以确保流动性提供者不会出现无偿债务。
- **费用更新**：同时，合约会更新该tick的费用状态，以跟踪在该tick上下的费用增长。

### 2024.08.29
- 为什么v3版本中提供了三种费率呢？0.05%，0.30%，1%
- 更好地适应不同交易对的特性:
- 不同的交易对可能有不同的波动性和流动性需求。例如，稳定币对(如USDC/USDT)可能适合较低的费率,如0.05%,因为它们的价格波动较小。而一些波动较大的代币对可能需要1%的较高费率来补偿流动性提供者的风险。
- UNI代币持有者可以通过治理添加新的费率选项,这为社区提供了一种调节协议行为的方式,使其能够随时间适应市场变化。
### 2024.08.30
Uniswap v3对价格预言机进行了几项重要改进:

1. 内部存储累加器检查点:
   v3在合约内部存储了累加器的检查点，而不是要求用户在链外跟踪先前的累加器值。这意味着外部合约可以直接计算最近一段时间的链上时间加权平均价格(TWAP)，无需自己存储累加器值的检查点。

2. 几何平均TWAP:
   v3从算术平均TWAP切换到几何平均TWAP。理论上，几何平均能更准确地表示平均价格，特别是在价格遵循几何布朗运动的情况下。

3. 更高效的存储:
   v3追踪的是log价格的累加和，而不是价格本身的累加和。这允许使用更少的位来表示广泛的价格范围，同时保持一致的精度。

4. 流动性累加器:
   v3引入了一个新的流动性累加器，追踪每秒钟1/L的累积值，其中L是当前范围内的虚拟流动性。这对实现流动性挖矿和判断哪个资金池的TWAP最可靠非常有用。

举例说明:
假设一个外部合约想要计算ETH/USDC交易对过去24小时的TWAP:
- 在v2中，该合约需要自己存储24小时前的累加器值，并在当前时间再次查询累加器值，然后计算TWAP。
- 在v3中，该合约可以直接调用池子合约的函数，传入"24小时"作为参数，合约会返回这段时间的TWAP，无需外部合约自己存储任何历史数据。
此外，如果有多个ETH/USDC池子(比如不同费率的池子)，外部合约可以使用流动性累加器来判断哪个池子的TWAP更可靠 - 通常是流动性更高的池子。这在v2中是无法直接做到的。

### 2024.08.31
Uniswap v3的非同质化流动性是该版本的一个重要特性，可以从以下几个方面理解:

1. 个性化流动性范围:
   在v3中，流动性提供者可以选择将流动性集中在特定的价格范围内，而不是像之前版本那样均匀分布在整个价格范围内。每个流动性位置都是独特的，因为它们可能有不同的价格范围和流动性数量。

2. ERC-721代币表示:
   v3不再使用ERC-20代币来表示流动性，而是使用非同质化的ERC-721代币。每个ERC-721代币代表了一个独特的流动性位置，包含了特定的价格范围和流动性数量信息。

3. 费用不自动复投:
   与v2不同，v3中赚取的费用不会自动复投为流动性。相反，费用是单独存储的，流动性提供者可以选择何时以及如何处理这些费用。

4. 更灵活的流动性管理:
   非同质化流动性允许流动性提供者更精细地管理他们的资产。他们可以根据市场情况和个人策略，创建多个不同的流动性位置。

5. 位置特定的状态跟踪:
   每个流动性位置都有自己的状态，包括流动性数量、未收取的费用等。这允许更精确的记账和更灵活的流动性管理。

6. 外部包装的可能性:
   移除原生流动性代币为更灵活的外部包装提供了可能性。开发者可以创建自定义的包装合约，为流动性提供者提供额外的功能或优化。

通过这种非同质化的设计，Uniswap v3为流动性提供者提供了更高的灵活性和资本效率，允许他们根据自己的市场预期和风险偏好来优化流动性配置。这种方法虽然增加了复杂性，但也大大提高了AMM的效率和适应性。
发现B站成都电子信息的梁培利老师[defi教程](https://www.bilibili.com/video/BV1Uz42167bf/?spm_id_from=pageDriver&vd_source=1718e94e94ec50d900260c4ac1632b74)
### 2024.09.01

## 去中心化预测市场概述

去中心化预测市场利用区块链技术创建各种事件的预测市场。与传统中心化平台相比具有以下优势:

- 降低交易费用
- 加快提款速度
- 避免账户冻结
- 允许用户创建自定义市场

## 预测协议运作机制

预测协议主要包含两个部分:

#### 做市商类型

- 基本类别型市场:YES(Long)和NO(Short)两种结果代币
- 多选型市场:多个选项代表不同答案
- 标量市场:结果在一定范围内变化,根据接近程度分配奖励

#### 决议模型

- 指定决议来源(如Coinbase价格)
- 使用预言机获取数据
- 依靠人工验证信息准确性
- 采用激励机制防止操纵

### 主要预测市场协议

##### Augur

- 使用REP代币激励准确报告
- 采用多轮争议机制解决分歧
- 链外订单簿提供流动性

##### Omen

- 使用Reality.eth作为去中心化预言机
- 依靠社区成员验证结果
- 可上诉至Kleros仲裁
- 自动做市商提供流动性

### 2024.09.02
- 今天学习固定利率协议
## 固定利率协议概述
固定利率协议旨在解决加密货币市场利率波动大的问题,为用户提供相对稳定的借贷利率。主要分为两类:
- 借出/借入协议
- 收益聚合器
## 主要固定利率协议
### Yield
- 使用fyTokens作为中间权益代币
- 提供固定利率借贷和利率市场
- 与Maker协议紧密结合
### Saffron Finance
- 风险分级协议
- 提供不同风险偏好的投资组合
- 创建内部保险系统

### Horizon
- 允许用户创建自己的市场
- 基于博弈论原则运作
- 用户可根据市场情况调整出价
### 2024.09.03

### 2024.09.04
- 学习去中心化收益聚合器的概念、主要协议及其运作机制。

## 收益聚合器概述
收益聚合器旨在自动化用户的投资策略,帮助用户捕捉DeFi市场中最佳的收益机会。

## 主要收益聚合器协议

### Yearn Finance
- 最初目的是实现借贷平台间资金自动转换以获得最佳收益
- 提供yToken作为有收益的代币
- 推出金库(vault)功能,允许自动化收益耕作
- 与多个DeFi协议建立合作关系,形成生态系统

### Alpha Finance
- 引入杠杆式收益耕作概念
- 允许用户借入资产增加流动性挖矿头寸
- 支持多种资产的借贷

### Badger DAO
- 专注于将比特币引入以太坊的DeFi生态系统
- 提供Sett收益聚合器,包括代币化BTC金库、LP金库和协议金库

### Harvest Finance
- 采取快速上线策略,支持大量农场
- 提供iFARM代币用于分享协议收益

## 收益聚合器比较
- 费用结构:Yearn收取管理费和绩效费,其他主要收取绩效费
- TVL:Yearn领先,Harvest被低估,Alpha估值较高

### 2024.09.05
- Uniswap V2[代码分析](https://github.com/kpyaoqi/UniswapV2_Chinese)

### 2024.09.06
Uniswap V2的核心特点包括以下几个方面：

- 去中心化交易：Uniswap V2使用智能合约来执行交易，而不需要传统的中心化交易所。这意味着用户可以直接通过他们的以太坊钱包进行交易，无需信任或依赖第三方中介。
- 自动化做市商模型：Uniswap V2采用自动化做市商模型，其中流动性提供者可以将资金存入流动性池中，并通过提供资金来帮助形成交易对的市场价格。这种模型使得任何人都可以成为流动性提供者，并从交易手续费中获得奖励。
- 常量乘积函数：Uniswap V2使用常量乘积函数作为交易价格计算模型。根据这个函数，交易所需的两种代币的数量乘积在交易前后保持不变，从而决定了交易价格。这种机制可以在没有订单簿的情况下进行交易，并保持相对简单和高效。
- ERC-20代币支持：Uniswap V2支持以太坊上的ERC-20代币进行交易。用户可以通过选择不同的代币对进行交易，并且任何人都可以创建新的代币对，只需提供相应的流动性即可。
- 流动性挖矿：Uniswap V2引入了流动性挖矿机制，通过奖励流动性提供者来吸引更多的资金注入流动性池。流动性提供者可以获得代币奖励作为对其提供流动性的补偿，如果市场价格剧烈波动，您存入的资金可能面临损失。
### 2024.09.07
uniswapV2手续费计算
```
假设一个交易池中，Token A 和 Token B 的数量都为 1000。现在有人想用 100 个 Token A 去兑换 Token B。

计算交易量： 由于滑点的原因，实际兑换到的 Token B 的数量会略小于 1000 / (1000 + 100) * 100 = 90.91。
计算交易后池子中的代币数量：
x' = 1000 - 100 + 100 * 0.003 ≈ 901.3
y' = 1000 * 1000 * 1.003 / 901.3 ≈ 1112.2
计算手续费： 手续费 = (901.3 * 1112.2 - 1000 * 1000) / 1000000 ≈ 3。
```
### 2024.09.08
- 了解uniswap和0x协议的不同点
1. 订单匹配方式
Uniswap: 采用自动做市商（AMM）模型，通过流动性池的方式进行交易。用户在交易时直接与流动性池进行交互，无需等待其他交易者的订单。
0x: 采用订单簿模型，订单在链下进行匹配，只有最终的交易结算才会上链。这种方式更类似于传统的中心化交易所，但去中心化程度更高。
2. 交易流程
Uniswap: 交易流程相对简单，用户直接向流动性池提交交易，合约会自动计算交易价格并执行交易。
0x: 交易流程相对复杂，涉及到订单创建、广播、匹配、结算等多个步骤。交易订单在链下由中继器进行匹配，然后由智能合约执行结算。
3. 灵活性
Uniswap: AMM模型相对简单，但灵活性较低，主要用于交易标准化的ERC20代币。
0x: 订单簿模型具有更高的灵活性，可以支持各种类型的交易，包括限价单、市价单、止损单等。此外，0x协议还可以支持自定义的交易逻辑。
4. 性能
Uniswap: 由于AMM模型的简单性，Uniswap的交易速度较快，但滑点可能较大。
0x: 0x协议的交易速度取决于中继器的性能，理论上可以实现更高的交易速度。同时，通过链下订单匹配，可以降低链上交易费用。
5. 其他区别
流动性: Uniswap通过流动性挖矿等激励方式吸引了大量的流动性，而0x的流动性主要依赖于接入0x协议的DEX。
生态: Uniswap已经构建了一个庞大的生态系统，而0x协议的生态还在不断发展中。
### 2024.09.09
### 2024.09.10
<!-- Content_END -->
